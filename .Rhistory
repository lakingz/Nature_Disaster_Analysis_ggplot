daplot[ daplot$region==0,]
datplot <- data.frame(daplot,tf=as.character((daplot$year-1970)%%perio))
ggplot(datplot,aes(x,y))+geom_point(aes(color=region))+
geom_smooth(method="lm", span=0.6) +
labs(x="Event Year", y="Costs Per Person") +
scale_color_manual(values=cols, label=c("North"))+
coord_cartesian( ylim=c(-8, 6)) +
geom_vline(xintercept = seq(as.numeric(as.Date("1970-01-01")),as.numeric(as.Date("2020-01-01")),perio*365), linetype=4)
ggplot(datplot,aes(x,y))+geom_point(aes(color=region))+
geom_smooth(method="lm", span=0.6) +
labs(x="Event Year", y="Costs Per Person") +
scale_color_manual(values=cols, label=c("North","West","Mid","East","Across Canada"))+
coord_cartesian( ylim=c(-8, 6)) +
geom_vline(xintercept = seq(as.numeric(as.Date("1970-01-01")),as.numeric(as.Date("2020-01-01")),perio*365), linetype=4)
ggplot(datplot,aes(x,y))+geom_point(aes(color=region))+
geom_smooth(method="lm", span=0.6) +
labs(x="Event Year", y="Costs Per Person") +
scale_color_manual(label=c("North","West","Mid","East","Across Canada"))+
coord_cartesian( ylim=c(-8, 6)) +
geom_vline(xintercept = seq(as.numeric(as.Date("1970-01-01")),as.numeric(as.Date("2020-01-01")),perio*365), linetype=4)
ggplot(datplot,aes(x,y))+geom_point(aes(color=region))+
geom_smooth(method="lm", span=0.6) +
labs(x="Event Year", y="Costs Per Person") +
scale_color_manual(value= cbPalette,label=c("North","West","Mid","East","Across Canada"))+
coord_cartesian( ylim=c(-8, 6)) +
geom_vline(xintercept = seq(as.numeric(as.Date("1970-01-01")),as.numeric(as.Date("2020-01-01")),perio*365), linetype=4)
ggplot(datplot,aes(x,y))+geom_point(aes(color=region))+
geom_smooth(method="lm", span=0.6) +
labs(x="Event Year", y="Costs Per Person") +
scale_color_manual(value=cbPalette,label=c("North","West","Mid","East","Across Canada"))+
coord_cartesian( ylim=c(-8, 6)) +
geom_vline(xintercept = seq(as.numeric(as.Date("1970-01-01")),as.numeric(as.Date("2020-01-01")),perio*365), linetype=4)
ggplot(datplot,aes(x,y))+geom_point(aes(color=region))+
geom_smooth(method="lm", span=0.6) +
labs(x="Event Year", y="Costs Per Person")+
coord_cartesian( ylim=c(-8, 6)) +
geom_vline(xintercept = seq(as.numeric(as.Date("1970-01-01")),
as.numeric(as.Date("2020-01-01")),perio*365), linetype=4) +
scale_color_manual(value=cbPalette,label=c("North","West","Mid","East","Across Canada"))
ggplot(datplot,aes(x,y))+geom_point(aes(color=region))+
geom_smooth(method="lm", span=0.6) +
labs(x="Event Year", y="Costs Per Person")+
coord_cartesian( ylim=c(-8, 6)) +
geom_vline(xintercept = seq(as.numeric(as.Date("1970-01-01")),
as.numeric(as.Date("2020-01-01")),perio*365), linetype=4)
ggplot(datplot,aes(x,y))+geom_point(aes(color=region))+
geom_smooth(method="lm", span=0.6) +
labs(x="Event Year", y="Costs Per Person")+
coord_cartesian( ylim=c(-8, 6)) +
geom_vline(xintercept = seq(as.numeric(as.Date("1970-01-01")),
as.numeric(as.Date("2020-01-01")),perio*365), linetype=4) +
scale_color_manual(value="Spectral",label=c("North","West","Mid","East","Across Canada"))
cols <- c("Flood"= alpha("royalblue",0.7) , "Wildfire"=alpha("firebrick1",0.7))
ggplot(datplot,aes(x,z,color=as.character(type)))+ geom_point(aes(size=y*100))+
labs(x='EVENT YEAR',y='Fatality',subtitle='Month',size="Eva/Pop(%)", color="Event Type") +
facet_grid(type~month) +
theme(axis.text.x = element_text(angle = 90, hjust = 0.9, vjust = 0.5))+
geom_vline(xintercept = 5)+
scale_colour_manual(values = cols,labels=c("Flood","Wildfire"))
ggplot(datplot,aes(x,y))+geom_point(aes(color=region))+
geom_smooth(method="lm", span=0.6) +
labs(x="Event Year", y="Costs Per Person")+
coord_cartesian( ylim=c(-8, 6)) +
geom_vline(xintercept = seq(as.numeric(as.Date("1970-01-01")),
as.numeric(as.Date("2020-01-01")),perio*365), linetype=4) +
scale_color_manual(value="Spectral",label=c("North","West","Mid","East","Across Canada"))
ggplot(datplot,aes(x,y))+geom_point(aes(color=region))+
geom_smooth(method="lm", span=0.6) +
labs(x="Event Year", y="Costs Per Person")+
coord_cartesian( ylim=c(-8, 6)) +
geom_vline(xintercept = seq(as.numeric(as.Date("1970-01-01")),
as.numeric(as.Date("2020-01-01")),perio*365), linetype=4) +
scale_color_manual(value="red",label=c("North","West","Mid","East","Across Canada"))
View(datplot)
View(datplot)
str(datplot)
ggplot(datplot,aes(x,y))+geom_point(aes(color=region))+
geom_smooth(method="lm", span=0.6) +
labs(x="Event Year", y="Costs Per Person")+
coord_cartesian( ylim=c(-8, 6)) +
geom_vline(xintercept = seq(as.numeric(as.Date("1970-01-01")),
as.numeric(as.Date("2020-01-01")),perio*365), linetype=4) +
scale_color_discrete(label=c("North","West","Mid","East","Across Canada"))
ggplot(datplot,aes(x,y))+geom_point(aes(color=region))+
geom_smooth(method="loess", span=0.6) +
labs(x="Event Year", y="Costs Per Person")+
coord_cartesian( ylim=c(-8, 6)) +
geom_vline(xintercept = seq(as.numeric(as.Date("1970-01-01")),
as.numeric(as.Date("2020-01-01")),perio*365), linetype=4) +
scale_color_discrete(label=c("North","West","Mid","East","Across Canada"))
ggplot(datplot,aes(x,y))+geom_point(aes(color=region))+
geom_smooth(method="loess", span=0.6) +
labs(x="Event Year", y="log Costs Per Person")+
coord_cartesian( ylim=c(-8, 6)) +
geom_vline(xintercept = seq(as.numeric(as.Date("1970-01-01")),
as.numeric(as.Date("2020-01-01")),perio*365), linetype=4) +
scale_color_discrete(label=c("North","West","Mid","East","Across Canada"))
ggplot(datplot,aes(x,y))+geom_point(aes(color=region))+
geom_smooth(method="loess", span=0.6) +
labs(x="Event Year", y="LOG Costs Per Person")+
coord_cartesian( ylim=c(-8, 6)) +
geom_vline(xintercept = seq(as.numeric(as.Date("1970-01-01")),
as.numeric(as.Date("2020-01-01")),perio*365), linetype=4) +
scale_color_discrete(label=c("North","West","Mid","East","Across Canada"))
ggplot(datplot,aes(x,y))+geom_point(aes(color=region))+
geom_smooth(method="loess", span=0.6) +
labs(x="Event Year", y="Costs Per Person (log)")+
coord_cartesian( ylim=c(-8, 6)) +
geom_vline(xintercept = seq(as.numeric(as.Date("1970-01-01")),
as.numeric(as.Date("2020-01-01")),perio*365), linetype=4) +
scale_color_discrete(label=c("North","West","Mid","East","Across Canada"))
ggplot(datplot,aes(x,y))+geom_point(aes(color=region))+
geom_smooth(method="loess", span=0.6) +
labs(x="Event Year", y="Costs Per Person (log)")+
coord_cartesian( ylim=c(-8, 6)) +
geom_vline(xintercept = seq(as.numeric(as.Date("1970-01-01")),
as.numeric(as.Date("2020-01-01")),perio*365), linetype=4) +
scale_color_discrete(label=c("North","West","Mid","East","Across Canada")) +
facet_grid(.~region)
ggplot(datplot,aes(x,y))+geom_point(aes(color=region))+
geom_smooth(method="loess", span=0.6) +
labs(x="Event Year", y="Costs Per Person (log)")+
coord_cartesian( ylim=c(-8, 6)) +
geom_vline(xintercept = seq(as.numeric(as.Date("1970-01-01")),
as.numeric(as.Date("2020-01-01")),perio*365), linetype=4) +
scale_color_discrete(label=c("North","West","Mid","East","Across Canada")) +
facet_grid(region~.)
ggplot(datplot,aes(x,y))+geom_point(aes(color=region))+
geom_smooth(method="loess", span=0.6) +
labs(x="Event Year", y="Costs Per Person (log)")+
coord_cartesian( ylim=c(-8, 6)) +
geom_vline(xintercept = seq(as.numeric(as.Date("1970-01-01")),
as.numeric(as.Date("2020-01-01")),perio*365), linetype=4) +
scale_color_discrete(label=c("North","West","Mid","East","Across Canada"))
ggplot(datplot,aes(x,y))+geom_point(aes(color=region))+
geom_smooth(data=datplot,aes(x,y),method="loess", span=0.6) +
labs(x="Event Year", y="Costs Per Person (log)")+
coord_cartesian( ylim=c(-8, 6)) +
geom_vline(xintercept = seq(as.numeric(as.Date("1970-01-01")),
as.numeric(as.Date("2020-01-01")),perio*365), linetype=4) +
scale_color_discrete(label=c("North","West","Mid","East","Across Canada"))
ggplot(datplot,aes(x,y))+geom_point(aes(color=region))+
geom_smooth(data=datplot,aes(x,y),method="loess", span=0.6) +
labs(x="Event Year", y="Costs Per Person (log)")+
coord_cartesian( ylim=c(-8, 6)) +
geom_vline(xintercept = seq(as.numeric(as.Date("1970-01-01")),
as.numeric(as.Date("2020-01-01")),perio*365), linetype=4) +
scale_color_discrete(label=c("North","West","Mid","East","Across Canada"))+
facet_grid(region~.)
ggplot(datplot,aes(x,y))+geom_point(aes(color=region))+
geom_smooth(data=datplot,aes(x,y),method="loess", span=0.6) +
labs(x="Event Year", y="Costs Per Person (log)")+
coord_cartesian( ylim=c(-8, 6)) +
geom_vline(xintercept = seq(as.numeric(as.Date("1970-01-01")),
as.numeric(as.Date("2020-01-01")),perio*365), linetype=4) +
scale_color_discrete(label=c("North","West","Mid","East","Across Canada"))+
facet_grid(region~.,margins=TRUE)
eg <- data.frame(x = c(1:50, 50:1),
y = c(1:50, 1:50) + rnorm(100),
g = rep(c("a","b"), each=50))
my.smooth <- gam(y ~ s(x), data = eg)
my.data <- data.frame(x = 1:50)
my.data$y <- predict(my.smooth, newdata = my.data)
my.smooth <- gam(y ~ s(x), data = eg)
library('readr')
library("lubridate")
library('rgl')
library('ggplot2')
my.smooth <- gam(y ~ s(x), data = eg)
my.smooth <- l(y ~ s(x), data = eg)
my.smooth <- lm(y ~ s(x), data = eg)
my.smooth <- lm(y ~ x, data = eg)
my.data <- data.frame(x = 1:50)
my.data$y <- predict(my.smooth, newdata = my.data)
qplot(x, y, data = eg) +
facet_wrap(~ g) +
geom_smooth() +
geom_smooth(data = my.data)
my.data <- data.frame(x = c(as.numeric(as.Date("1970-01-01")):as.numeric(as.Date("2020-01-01"))))
my.data$y <- predict(my.smooth, newdata = my.data)
ggplot(datplot,aes(x,y))+geom_point(aes(color=region))+
geom_smooth(data=my.data, span=0.6) +
labs(x="Event Year", y="Costs Per Person (log)")+
coord_cartesian( ylim=c(-8, 6)) +
geom_vline(xintercept = seq(as.numeric(as.Date("1970-01-01")),
as.numeric(as.Date("2020-01-01")),perio*365), linetype=4) +
scale_color_discrete(label=c("North","West","Mid","East","Across Canada"))+
facet_grid(region~.)
my.smooth <- lm(y ~ x, data = datplot)
my.data <- data.frame(x = c(as.numeric(as.Date("1970-01-01")):as.numeric(as.Date("2020-01-01"))))
my.data$y <- predict(my.smooth, newdata = my.data)
my.data
datplot
my.smooth <- lm(y ~ x, data = datplot)
my.data <- data.frame(x = datplot$x)
my.data$y <- predict(my.smooth, newdata = my.data)
ggplot(datplot,aes(x,y))+geom_point(aes(color=region))+
geom_smooth(data=my.data, span=0.6) +
labs(x="Event Year", y="Costs Per Person (log)")+
coord_cartesian( ylim=c(-8, 6)) +
geom_vline(xintercept = seq(as.numeric(as.Date("1970-01-01")),
as.numeric(as.Date("2020-01-01")),perio*365), linetype=4) +
scale_color_discrete(label=c("North","West","Mid","East","Across Canada"))+
facet_grid(region~.)
ggplot(datplot,aes(x,y))+geom_point(aes(color=region))+
geom_smooth(data=my.data, ,se = TRUE,span=0.6) +
labs(x="Event Year", y="Costs Per Person (log)")+
coord_cartesian( ylim=c(-8, 6)) +
geom_vline(xintercept = seq(as.numeric(as.Date("1970-01-01")),
as.numeric(as.Date("2020-01-01")),perio*365), linetype=4) +
scale_color_discrete(label=c("North","West","Mid","East","Across Canada"))+
facet_grid(region~.)
ggplot(datplot,aes(x,y))+geom_point(aes(color=region))+
geom_smooth(data=my.data,se = TRUE,span=0.6) +
labs(x="Event Year", y="Costs Per Person (log)")+
coord_cartesian( ylim=c(-8, 6)) +
geom_vline(xintercept = seq(as.numeric(as.Date("1970-01-01")),
as.numeric(as.Date("2020-01-01")),perio*365), linetype=4) +
scale_color_discrete(label=c("North","West","Mid","East","Across Canada"))+
facet_grid(region~.)
ggplot(datplot,aes(x,y))+geom_point(aes(color=region))+
geom_smooth(data=my.data,method="lm",se = TRUE,span=0.6) +
labs(x="Event Year", y="Costs Per Person (log)")+
coord_cartesian( ylim=c(-8, 6)) +
geom_vline(xintercept = seq(as.numeric(as.Date("1970-01-01")),
as.numeric(as.Date("2020-01-01")),perio*365), linetype=4) +
scale_color_discrete(label=c("North","West","Mid","East","Across Canada"))+
facet_grid(region~.)
ggplot(datplot,aes(x,y))+geom_point(aes(color=region))+
geom_smooth(data=my.data,method="lm") +
labs(x="Event Year", y="Costs Per Person (log)")+
coord_cartesian( ylim=c(-8, 6)) +
geom_vline(xintercept = seq(as.numeric(as.Date("1970-01-01")),
as.numeric(as.Date("2020-01-01")),perio*365), linetype=4) +
scale_color_discrete(label=c("North","West","Mid","East","Across Canada"))+
facet_grid(region~.)
ggplot(datplot,aes(x,y))+geom_point(aes(color=region))+
geom_smooth(method="loess", span=0.6) +
labs(x="Event Year", y="Costs Per Person (log)")+
coord_cartesian( ylim=c(-8, 6)) +
geom_vline(xintercept = seq(as.numeric(as.Date("1970-01-01")),
as.numeric(as.Date("2020-01-01")),perio*365), linetype=4) +
scale_color_discrete(label=c("North","West","Mid","East","Across Canada"))
ggplot(datplot,aes(x,y))+geom_point(aes(color=region))+
geom_smooth(data=my.data,method="loess") +
labs(x="Event Year", y="Costs Per Person (log)")+
coord_cartesian( ylim=c(-8, 6)) +
geom_vline(xintercept = seq(as.numeric(as.Date("1970-01-01")),
as.numeric(as.Date("2020-01-01")),perio*365), linetype=4) +
scale_color_discrete(label=c("North","West","Mid","East","Across Canada"))+
facet_grid(region~.)
View(dat)
View(dat)
ggplot(datplot,aes(x,y))+geom_point(aes(color=region))+
geom_smooth(method="loess", span=0.6) +
labs(x="Event Year", y="Costs Per Person (log)")+
coord_cartesian( ylim=c(-8, 6)) +
geom_vline(xintercept = seq(as.numeric(as.Date("1970-01-01")),
as.numeric(as.Date("2020-01-01")),perio*365), linetype=4) +
scale_color_discrete(label=c("North","West","Mid","East","Across Canada"))
daplot[ daplot$region!=5 ,]
daplot <- daplot[ daplot$region!=5 ,]
datplot <- data.frame(daplot,tf=as.character((daplot$year-1970)%%perio))
ggplot(datplot,aes(x,y))+geom_point(aes(color=region))+
geom_smooth(method="loess", span=0.6) +
labs(x="Event Year", y="Costs Per Person (log)")+
coord_cartesian( ylim=c(-8, 6)) +
geom_vline(xintercept = seq(as.numeric(as.Date("1970-01-01")),
as.numeric(as.Date("2020-01-01")),perio*365), linetype=4) +
scale_color_discrete(label=c("North","West","Mid","East","Across Canada"))
my.smooth <- lm(y ~ x, data = datplot)
my.data <- data.frame(x = datplot$x)
my.data$y <- predict(my.smooth, newdata = my.data)
ggplot(datplot,aes(x,y))+geom_point(aes(color=region))+
geom_smooth(data=my.data,method="loess") +
labs(x="Event Year", y="Costs Per Person (log)")+
coord_cartesian( ylim=c(-8, 6)) +
geom_vline(xintercept = seq(as.numeric(as.Date("1970-01-01")),
as.numeric(as.Date("2020-01-01")),perio*365), linetype=4) +
scale_color_discrete(label=c("North","West","Mid","East","Across Canada"))+
facet_grid(region~.)
svg("ankai_cost_per_person.svg", width = 10.75, height = 8)
plot(g1)
dev.off()
svg("ankai_cost_per_person.svg", width = 10.75, height = 8)
plot(g1)
dev.off()
ggplot(datplot,aes(x,y))+geom_point(aes(color=region))+
geom_smooth(data=my.data,method="loess") +
labs(x="Event Year", y="Costs Per Person (log)")+
coord_cartesian( ylim=c(-8, 6)) +
geom_vline(xintercept = seq(as.numeric(as.Date("1970-01-01")),
as.numeric(as.Date("2020-01-01")),perio*365), linetype=4) +
scale_color_discrete(label=c("North","West","Mid","East","Across Canada"))+
facet_grid(region~.)
g1<-ggplot(datplot,aes(x,y))+geom_point(aes(color=region))+
geom_smooth(data=my.data,method="loess") +
labs(x="Event Year", y="Costs Per Person (log)")+
coord_cartesian( ylim=c(-8, 6)) +
geom_vline(xintercept = seq(as.numeric(as.Date("1970-01-01")),
as.numeric(as.Date("2020-01-01")),perio*365), linetype=4) +
scale_color_discrete(label=c("North","West","Mid","East","Across Canada"))+
facet_grid(region~.)
svg("ankai_cost_per_person.svg", width = 10.75, height = 8)
plot(g1)
dev.off()
ggplot(datplot,aes(x,y))+geom_point(aes(color=region))+
geom_smooth(data=my.data,method="loess") +
labs(x="Event Year", y="Costs Per Person (log)")+
coord_cartesian( ylim=c(-10, 6)) +
geom_vline(xintercept = seq(as.numeric(as.Date("1970-01-01")),
as.numeric(as.Date("2020-01-01")),perio*365), linetype=4) +
scale_color_discrete(label=c("North","West","Mid","East","Across Canada"))+
facet_grid(region~.)
ggplot(datplot,aes(x,y))+geom_point(aes(color=region))+
geom_smooth(data=my.data,method="loess") +
labs(x="Event Year", y="Costs Per Person (log)")+
coord_cartesian( ylim=c(-8, 6)) +
geom_vline(xintercept = seq(as.numeric(as.Date("1970-01-01")),
as.numeric(as.Date("2020-01-01")),perio*365), linetype=4) +
scale_color_discrete(label=c("North","West","Mid","East","Across Canada"))+
facet_grid(region~.)
fitting
my.smooth <- loess(y ~ x, data = datplot)
my.smooth <- lm(y ~ x, data = datplot)
?lm
my.smooth <- sma(y ~ x, data = datplot)
my.smooth <- loess(y ~ x, data = datplot)
?loess
my.smooth <- loess(y ~ x, data = datplot)
my.data <- data.frame(x = datplot$x)
my.data$y <- predict(my.smooth, newdata = my.data)
ggplot(datplot,aes(x,y))+geom_point(aes(color=region))+
geom_smooth(data=my.data,method="loess") +
labs(x="Event Year", y="Costs Per Person (log)")+
coord_cartesian( ylim=c(-8, 6)) +
geom_vline(xintercept = seq(as.numeric(as.Date("1970-01-01")),
as.numeric(as.Date("2020-01-01")),perio*365), linetype=4) +
scale_color_discrete(label=c("North","West","Mid","East","Across Canada"))+
facet_grid(region~.)
my.smooth <- lm(y ~ x, data = datplot)
my.data <- data.frame(x = datplot$x)
my.data$y <- predict(my.smooth, newdata = my.data)
ggplot(datplot,aes(x,y))+geom_point(aes(color=region))+
geom_smooth(data=my.data,method="loess") +
labs(x="Event Year", y="Costs Per Person (log)")+
coord_cartesian( ylim=c(-8, 6)) +
geom_vline(xintercept = seq(as.numeric(as.Date("1970-01-01")),
as.numeric(as.Date("2020-01-01")),perio*365), linetype=4) +
scale_color_discrete(label=c("North","West","Mid","East","Across Canada"))+
facet_grid(region~.)
svg("ankai_cost_per_person.svg", width = 10.75, height = 8)
ggplot(datplot,aes(x,y))+geom_point(aes(color=region))+
geom_smooth(data=my.data,size=1) +
labs(x="Event Year", y="Costs Per Person (log)")+
coord_cartesian( ylim=c(-8, 6)) +
geom_vline(xintercept = seq(as.numeric(as.Date("1970-01-01")),
as.numeric(as.Date("2020-01-01")),perio*365), linetype=4) +
scale_color_discrete(label=c("North","West","Mid","East","Across Canada"))+
facet_grid(region~.)
ggplot(datplot,aes(x,y))+geom_point(aes(color=region))+
geom_smooth(data=my.data,size=0.5) +
labs(x="Event Year", y="Costs Per Person (log)")+
coord_cartesian( ylim=c(-8, 6)) +
geom_vline(xintercept = seq(as.numeric(as.Date("1970-01-01")),
as.numeric(as.Date("2020-01-01")),perio*365), linetype=4) +
scale_color_discrete(label=c("North","West","Mid","East","Across Canada"))+
facet_grid(region~.)
region <- rep(0,nrow(dat))
for (i in 1:nrow(dat)) {
if (grepl("AB", dat$`Province/Territory`[i], fixed = TRUE)==TRUE) {region[i] <- 2}
if (grepl("MB", dat$`Province/Territory`[i], fixed = TRUE)==TRUE) {region[i] <- 2}
if (grepl("NB", dat$`Province/Territory`[i], fixed = TRUE)==TRUE) {region[i] <- 4}
if (grepl("NL", dat$`Province/Territory`[i], fixed = TRUE)==TRUE) {region[i] <- 4}
if (grepl("QC", dat$`Province/Territory`[i], fixed = TRUE)==TRUE) {region[i] <- 3}
if (grepl("YT", dat$`Province/Territory`[i], fixed = TRUE)==TRUE) {region[i] <- 1}
if (grepl("NS", dat$`Province/Territory`[i], fixed = TRUE)==TRUE) {region[i] <- 4}
if (grepl("BC", dat$`Province/Territory`[i], fixed = TRUE)==TRUE) {region[i] <- 2}
if (grepl("ON", dat$`Province/Territory`[i], fixed = TRUE)==TRUE) {region[i] <- 3}
if (grepl("SK", dat$`Province/Territory`[i], fixed = TRUE)==TRUE) {region[i] <- 2}
if (grepl("Eastern Canada", dat$`Province/Territory`[i], fixed = TRUE)==TRUE) {region[i] <- 4}
if (grepl("Maritimes", dat$`Province/Territory`[i], fixed = TRUE)==TRUE) {region[i] <- 4}
if (grepl("Prairies", dat$`Province/Territory`[i], fixed = TRUE)==TRUE) {region[i] <- 2}
if (grepl("Across Canada", dat$`Province/Territory`[i], fixed = TRUE)==TRUE) {region[i] <- 5}
if (grepl("PE", dat$`Province/Territory`[i], fixed = TRUE)==TRUE) {region[i] <- 4}
if (grepl("NU", dat$`Province/Territory`[i], fixed = TRUE)==TRUE) {region[i] <- 1}
if (grepl("NT", dat$`Province/Territory`[i], fixed = TRUE)==TRUE) {region[i] <- 1}
}
daplot <- data.frame(x=as.Date(dat$`EVENT START DATE`),
y=log(dat$`ESTIMATED TOTAL COST`/dat$Population),
type=dat$`EVENT TYPE`,
month=as.numeric(strftime(dat$`EVENT START DATE`,"%m")),
year=as.numeric(strftime(dat$`EVENT START DATE`,"%Y")),
z=log(dat$`NORMALIZED TOTAL COST`),
region=as.character(region))
test <- data.frame(dat$`Province/Territory`,region)
test[test$region==4,]
perio <-10
daplot <- daplot[ daplot$region!=5 ,]
datplot <- data.frame(daplot,tf=as.character((daplot$year-1970)%%perio))
sqrt(var(table(datplot$tf)))
ggplot(datplot)+geom_histogram(aes(tf),stat="count")+
labs(x="log Total Costs", y="frequency")
ggplot(datplot,aes(x,y))+geom_point(aes(color=region))+
geom_smooth(method="loess", span=0.6) +
labs(x="Event Year", y="Costs Per Person (log)")+
coord_cartesian( ylim=c(-8, 6)) +
geom_vline(xintercept = seq(as.numeric(as.Date("1970-01-01")),
as.numeric(as.Date("2020-01-01")),perio*365), linetype=4) +
scale_color_discrete(label=c("North","West","Mid","East","Across Canada"))
my.smooth <- lm(y ~ x, data = datplot)
daplot <- data.frame(x=as.Date(dat$`EVENT START DATE`),
y=log(dat$`ESTIMATED TOTAL COST`/dat$Population),
type=dat$`EVENT TYPE`,
month=as.numeric(strftime(dat$`EVENT START DATE`,"%m")),
year=as.numeric(strftime(dat$`EVENT START DATE`,"%Y")),
z=log(dat$`NORMALIZED TOTAL COST`),
region=as.character(region))
test <- data.frame(dat$`Province/Territory`,region)
test[test$region==4,]
my.smooth <- lm(y ~ x, data = datplot)
my.data <- data.frame(x = datplot$x)
my.data$y <- predict(my.smooth, newdata = my.data)
ggplot(datplot,aes(x,y))+geom_point(aes(color=region))+
geom_smooth(data=my.data,size=0.5) +
labs(x="Event Year", y="Costs Per Person (log)")+
coord_cartesian( ylim=c(-8, 6)) +
geom_vline(xintercept = seq(as.numeric(as.Date("1970-01-01")),
as.numeric(as.Date("2020-01-01")),perio*365), linetype=4) +
scale_color_discrete(label=c("North","West","Mid","East","Across Canada"))+
facet_grid(region~.)
g1 <- ggplot(datplot,aes(x,y))+geom_point(aes(color=region))+
geom_smooth(data=my.data,size=0.5) +
labs(x="Event Year", y="Costs Per Person (log)")+
coord_cartesian( ylim=c(-8, 6)) +
geom_vline(xintercept = seq(as.numeric(as.Date("1970-01-01")),
as.numeric(as.Date("2020-01-01")),perio*365), linetype=4) +
scale_color_discrete(label=c("North","West","Mid","East","Across Canada"))+
facet_grid(region~.)
svg("ankai_cost_per_person.svg", width = 10.75, height = 8)
plot(g1)
dev.off()
test[test$region==3,]
test[test$region==2,]
test[test$region==1,]
ggplot(datplot,aes(x,y))+geom_point(aes(color=region))+
geom_smooth(method="loess", span=0.6) +
labs(x="Event Year", y="Costs Per Person (log)")+
coord_cartesian( ylim=c(-8, 6)) +
geom_vline(xintercept = seq(as.numeric(as.Date("1970-01-01")),
as.numeric(as.Date("2020-01-01")),perio*365), linetype=4) +
scale_color_discrete(label=c("North","West","Mid","East","Across Canada"))
my.smooth <- lm(y ~ x, data = datplot)
my.data <- data.frame(x = datplot$x)
my.data$y <- predict(my.smooth, newdata = my.data)
g1 <- ggplot(datplot,aes(x,y))+geom_point(aes(color=region))+
geom_smooth(data=my.data,size=0.5) +
labs(x="Event Year", y="Costs Per Person (log)")+
coord_cartesian( ylim=c(-8, 6)) +
geom_vline(xintercept = seq(as.numeric(as.Date("1970-01-01")),
as.numeric(as.Date("2020-01-01")),perio*365), linetype=4) +
scale_color_discrete(label=c("North","West","Mid","East","Across Canada"))+
facet_grid(region~.)
g1
svg("ankai_cost_per_person.svg", width = 10.75, height = 8)
plot(g1)
dev.off()
svg("ankai_cost_per_person_1.svg", width = 10.75, height = 8)
g1 <- ggplot(datplot,aes(x,y))+geom_point(aes(color=region))+
geom_smooth(data=my.data,size=0.5) +
labs(x="Event Year", y="Costs Per Person (log)")+
coord_cartesian( ylim=c(-8, 6)) +
geom_vline(xintercept = seq(as.numeric(as.Date("1970-01-01")),
as.numeric(as.Date("2020-01-01")),perio*365), linetype=4) +
scale_color_discrete(label=c("North","West","Mid","East","Across Canada"))+
facet_grid(region~.)
svg("ankai_cost_per_person_1.svg", width = 10.75, height = 8)
plot(g1)
dev.off()
g1
test <- cor.test(df$Gender,df$T1MH)
library(readxl)
library('ggplot2')
library(fitdistrplus)
df <- read_excel("C:/Users/ankai/Desktop/important saves/statistic intro/assignment#1/Assignment1.xls")
df
test <- cor.test(df$Gender,df$T1MH)
test
fitL <- lm(df$T1MH~df$Gender)
anova(fitL)
summary(fitL)
my_data <- data.frame(x=df$T1MH,y1=df$Gender,y2=df$`AgeGroups 1<30, 2=30-49, 3=50-64, 4=65+`,index=1:nrow(df))
fitL <- lm((x)~(y1)+y2,my_data)
anova(fitL)
summary(fitL)
plot(my_data$x)
plot(s_tL$y)
s_tL <- data.frame(y=predict(fitL))
hist(my_data$x-s_tL$y)
plot(my_data$x)
plot(s_tL$y)
fitL <- lm(x~y1+y2+y3+y4+y5,my_data)
my_data <- data.frame(x=df$T1MH,y1=df$`Agreeable Agreeableness`,y2=df$`Cons Conscientiousness`,y3=df$`Extra  Extraversion`,y4=df$`Neurotic  Neuroticism`,y5=df$`Open Openness`,index=1:nrow(df))
fitL <- lm(x~y1+y2+y3+y4+y5,my_data)
anova(fitL)
summ <- summary(fitL)
test <- cor.test(df$Gender,df$T1MH)
test
fitL <- lm(df$T1MH~df$Gender)
anova(fitL)
summary(fitL)
anova(fitL)
